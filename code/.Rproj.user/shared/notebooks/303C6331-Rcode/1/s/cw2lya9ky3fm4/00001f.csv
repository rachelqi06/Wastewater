"0","#Demographic matrix"
"0","metadata <- data.frame(NCWW_2021@sam_data)"
"0","X <- metadata[, 27:63]"
"0","X_scaled <- scale(X, center = TRUE, scale = TRUE)"
"0",""
"0","library(textshape)"
"0","# PCA by prcomp() on count table"
"0","pca_df <- data.frame(X_scaled)"
"0","pca_df$Location <- metadata$Location"
"0",""
"0","# from combined_df, calculate the average read counts by Location"
"0","pca_df <- pca_df %>% "
"0","  group_by(Location) %>%"
"0","  summarise(across("
"0","    .cols = where(is.numeric),  # Selects all numeric columns"
"0","    .fns = ~ mean(.x, na.rm = TRUE)  # Calculate the mean, remove NA values"
"0","  )) %>%"
"0","  ungroup() %>%  # Remove grouping"
"0","  column_to_rownames(""Location"")  # Convert 'Location' column to row names"
"0",""
"0","# PCA"
"0","res.pca <- prcomp(pca_df, center = TRUE, scale. = TRUE)"
"0","pc_loadings <- res.pca$x"
"0",""
"0","library(factoextra)"
"2","Warning: package ‘factoextra’ was built under R version 4.4.1"
"2","Welcome! Want to learn more? See two factoextra-related books at https://goo.gl/ve3WBa
"
"0","plot_pca <- fviz_pca_biplot(res.pca, repel = TRUE,              # label = ""var"" only display the labels for var."
"0","                col.var = ""red"", # Variables color"
"0","                col.ind = ""grey"",  # Individuals color"
"0","                select.var = list(contrib = 15), pointsize = 3, labelsize = 5,"
"0","                ggtheme = theme_minimal()) + theme(text = element_text(size = 12),"
"0","        axis.title = element_text(size = 12),"
"0","        axis.text = element_text(size = 12))"
"0","plot_pca"
