"0",""
"0","#Fit the model with optimal components"
"0","optimal_components <- which.min(pls_model$validation$PRESS)"
"0","pls_model <- plsr(Y ~ X, ncomp = optimal_components, data = SeasonFood, validation = ""CV"")"
"0","summary(pls_model)"
"1","Data: 	X dimension:"
"1"," "
"1","147"
"1"," "
"1","97"
"1"," "
"1","
	Y dimension:"
"1"," "
"1","147"
"1"," "
"1","1"
"1","
Fit method:"
"1"," "
"1","kernelpls"
"1","
Number of components considered:"
"1"," "
"1","2"
"1","

VALIDATION: RMSEP"
"1","
Cross-validated using"
"1"," "
"1","10"
"1"," "
"1","random"
"1"," "
"1","segments.
"
"1","     "
"1","  (Intercept)"
"1","  1 comps"
"1","  2 comps"
"1","
CV   "
"1","        52.51"
"1","    51.42"
"1","    50.68"
"1","
adjCV"
"1","        52.51"
"1","    51.05"
"1","    50.18"
"1","
"
"1","
TRAINING: % variance explained
"
"1"," "
"1","  1 comps"
"1","  2 comps"
"1","
X"
"1","    6.654"
"1","    15.83"
"1","
Y"
"1","   29.622"
"1","    39.47"
"1","
"
"0","# RMSE-P"
"0","RMSEP(pls_model)"
"1","     "
"1","  (Intercept)"
"1","  1 comps"
"1","  2 comps"
"1","
CV   "
"1","        52.51"
"1","    51.42"
"1","    50.68"
"1","
adjCV"
"1","        52.51"
"1","    51.05"
"1","    50.18"
"1","
"
"0","# Calculate VIP scores"
"0","vip_scores <- calculate_vip(pls_model)"
"0","vip_scores"
"1"," [1]"
"1"," 0.56878946"
"1"," 0.37171093"
"1"," 0.64768455"
"1"," 0.20243023"
"1"," 0.49084622"
"1"," 2.37585249"
"1"," 0.66142716"
"1"," 0.60198807"
"1"," 0.89996765"
"1"," 0.18935410"
"1","
"
"1","[11]"
"1"," 1.20657277"
"1"," 0.79139341"
"1"," 0.30210034"
"1"," 0.29113709"
"1"," 0.71249644"
"1"," 0.99773855"
"1"," 0.27054151"
"1"," 0.27072379"
"1"," 0.18695146"
"1"," 0.31644204"
"1","
"
"1","[21]"
"1"," 0.62259188"
"1"," 0.23109162"
"1"," 0.34079740"
"1"," 0.28452254"
"1"," 0.35058477"
"1"," 0.25473955"
"1"," 0.54168415"
"1"," 0.80277462"
"1"," 0.12580265"
"1"," 0.11675615"
"1","
"
"1","[31]"
"1"," 0.79145496"
"1"," 1.42235518"
"1"," 0.34704523"
"1"," 0.19858371"
"1"," 0.82789432"
"1"," 0.20831160"
"1"," 1.67942004"
"1"," 0.30224805"
"1"," 0.27745305"
"1"," 0.74869660"
"1","
"
"1","[41]"
"1"," 1.01451594"
"1"," 2.26943721"
"1"," 1.23253290"
"1"," 1.96189361"
"1"," 2.30291131"
"1"," 0.40155132"
"1"," 0.50662887"
"1"," 0.42115729"
"1"," 0.26461476"
"1"," 1.13701510"
"1","
"
"1","[51]"
"1"," 0.38909689"
"1"," 0.73051773"
"1"," 5.09794614"
"1"," 0.42271450"
"1"," 1.02277105"
"1"," 0.28785882"
"1"," 0.59578019"
"1"," 0.93216232"
"1"," 0.96172769"
"1"," 0.67858143"
"1","
"
"1","[61]"
"1"," 0.14817142"
"1"," 0.87925213"
"1"," 0.71249644"
"1"," 0.52262317"
"1"," 0.43457503"
"1"," 0.42231128"
"1"," 0.09708245"
"1"," 0.64314289"
"1"," 0.57359734"
"1"," 0.49837204"
"1","
"
"1","[71]"
"1"," 0.62191349"
"1"," 0.31598108"
"1"," 0.19606431"
"1"," 0.16347815"
"1"," 0.25049373"
"1"," 0.21821154"
"1"," 0.29426177"
"1"," 0.30546026"
"1"," 0.85986849"
"1"," 0.25607025"
"1","
"
"1","[81]"
"1"," 0.35504936"
"1"," 0.27216994"
"1"," 0.52063855"
"1"," 0.74603941"
"1"," 0.27352175"
"1"," 1.42853898"
"1"," 0.38913559"
"1"," 0.33915481"
"1"," 0.31949672"
"1"," 1.54857136"
"1","
"
"1","[91]"
"1"," 0.98435423"
"1"," 0.18940277"
"1"," 3.65171453"
"1"," 0.46068779"
"1"," 0.87627042"
"1"," 0.36650499"
"1"," 0.51774238"
"1","
"
"0","# Loading plot"
"0","pls_model <- plsr(Y ~ X, ncomp = optimal_components, data = SeasonFood, validation = ""CV"")"
"0","loadingplot(pls_model, comps = 1:optimal_components, legendpos = ""topright"","
"0","            xlab = ""Contributor"", ylab = ""Loadings"","
"0","            main = ""PLS Loadings Plot"")"
