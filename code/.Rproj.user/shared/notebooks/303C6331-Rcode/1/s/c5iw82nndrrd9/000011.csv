"0",""
"0","#Fit the model with optimal components"
"0","optimal_components <- which.min(pls_model$validation$PRESS)"
"0","pls_model <- plsr(Y ~ X, ncomp = optimal_components, data = SeasonFood, validation = ""CV"")"
"0","summary(pls_model)"
"1","Data: 	X dimension:"
"1"," "
"1","147"
"1"," "
"1","179"
"1"," "
"1","
	Y dimension:"
"1"," "
"1","147"
"1"," "
"1","1"
"1","
Fit method:"
"1"," "
"1","kernelpls"
"1","
Number of components considered:"
"1"," "
"1","2"
"1","

VALIDATION: RMSEP"
"1","
Cross-validated using"
"1"," "
"1","10"
"1"," "
"1","random"
"1"," "
"1","segments.
"
"1","     "
"1","  (Intercept)"
"1","  1 comps"
"1","  2 comps"
"1","
CV   "
"1","        52.51"
"1","    44.13"
"1","    43.01"
"1","
adjCV"
"1","        52.51"
"1","    43.78"
"1","    42.76"
"1","
"
"1","
TRAINING: % variance explained
"
"1"," "
"1","  1 comps"
"1","  2 comps"
"1","
X"
"1","    5.296"
"1","    12.76"
"1","
Y"
"1","   49.142"
"1","    62.18"
"1","
"
"0","# RMSE-P"
"0","RMSEP(pls_model)"
"1","     "
"1","  (Intercept)"
"1","  1 comps"
"1","  2 comps"
"1","
CV   "
"1","        52.51"
"1","    44.13"
"1","    43.01"
"1","
adjCV"
"1","        52.51"
"1","    43.78"
"1","    42.76"
"1","
"
"0","# Calculate VIP scores"
"0","vip_scores <- calculate_vip(pls_model)"
"0","vip_scores"
"1","  [1]"
"1"," 1.1827005"
"1"," 1.0250740"
"1"," 0.7224185"
"1"," 1.5372573"
"1"," 0.2142514"
"1"," 1.9766260"
"1"," 0.6661987"
"1"," 0.5176204"
"1"," 0.8795148"
"1"," 1.7013347"
"1"," 0.8698383"
"1","
"
"1"," [12]"
"1"," 0.7926153"
"1"," 0.7748628"
"1"," 1.3062564"
"1"," 0.3691489"
"1"," 1.4119226"
"1"," 0.9164132"
"1"," 2.2473613"
"1"," 1.3408312"
"1"," 2.0566148"
"1"," 2.5834638"
"1"," 1.9546981"
"1","
"
"1"," [23]"
"1"," 1.3228239"
"1"," 1.6535242"
"1"," 2.2403283"
"1"," 0.9185943"
"1"," 2.3587182"
"1"," 1.3176423"
"1"," 1.7338444"
"1"," 2.3011790"
"1"," 1.3867750"
"1"," 1.1576201"
"1"," 0.8058387"
"1","
"
"1"," [34]"
"1"," 1.4227716"
"1"," 0.8808261"
"1"," 1.7078979"
"1"," 1.0742523"
"1"," 2.3710781"
"1"," 1.2035431"
"1"," 0.7553058"
"1"," 2.5096995"
"1"," 0.5294679"
"1"," 0.9857876"
"1"," 2.3123838"
"1","
"
"1"," [45]"
"1"," 0.8280346"
"1"," 0.7663642"
"1"," 0.8540077"
"1"," 0.8707222"
"1"," 1.8457306"
"1"," 1.2802093"
"1"," 1.7593557"
"1"," 0.6637985"
"1"," 0.9141619"
"1"," 1.7623408"
"1"," 0.7921960"
"1","
"
"1"," [56]"
"1"," 0.3715742"
"1"," 0.7382829"
"1"," 0.9728021"
"1"," 1.1404315"
"1"," 1.5383027"
"1"," 1.7144773"
"1"," 1.2196438"
"1"," 0.6335825"
"1"," 0.9218011"
"1"," 0.3931837"
"1"," 1.3680289"
"1","
"
"1"," [67]"
"1"," 0.6982794"
"1"," 2.1980360"
"1"," 0.7691212"
"1"," 0.7403236"
"1"," 1.0693612"
"1"," 1.1361831"
"1"," 0.7378106"
"1"," 0.5729924"
"1"," 0.8244039"
"1"," 0.2535168"
"1"," 0.2946460"
"1","
"
"1"," [78]"
"1"," 1.6926654"
"1"," 0.3637049"
"1"," 0.7671819"
"1"," 1.4981272"
"1"," 0.2597549"
"1"," 1.3472912"
"1"," 0.4944128"
"1"," 0.8006589"
"1"," 0.2930281"
"1"," 0.6605729"
"1"," 0.7760440"
"1","
"
"1"," [89]"
"1"," 1.0730791"
"1"," 0.4653415"
"1"," 1.4064493"
"1"," 0.9558809"
"1"," 0.4235879"
"1"," 0.2462407"
"1"," 0.4069111"
"1"," 0.2490356"
"1"," 0.5523954"
"1"," 0.3614483"
"1"," 0.3217125"
"1","
"
"1","[100]"
"1"," 0.3849094"
"1"," 0.6269863"
"1"," 0.2037739"
"1"," 0.5473941"
"1"," 0.3101100"
"1"," 0.5185194"
"1"," 0.3673314"
"1"," 0.4921976"
"1"," 0.5086946"
"1"," 0.3378365"
"1"," 0.6264291"
"1","
"
"1","[111]"
"1"," 0.6037394"
"1"," 0.7512051"
"1"," 0.7281590"
"1"," 0.9166229"
"1"," 0.4147063"
"1"," 0.4738539"
"1"," 0.5647400"
"1"," 0.3417475"
"1"," 0.4278919"
"1"," 0.4472355"
"1"," 0.7002088"
"1","
"
"1","[122]"
"1"," 0.5890622"
"1"," 0.5759988"
"1"," 0.2750756"
"1"," 0.7569260"
"1"," 1.3240654"
"1"," 0.2415365"
"1"," 0.3886231"
"1"," 0.2612126"
"1"," 0.3854467"
"1"," 0.7086916"
"1"," 0.7165049"
"1","
"
"1","[133]"
"1"," 0.7120847"
"1"," 0.6578729"
"1"," 0.3614876"
"1"," 0.3046843"
"1"," 0.3328503"
"1"," 0.1546001"
"1"," 0.4902148"
"1"," 0.5160337"
"1"," 0.2439958"
"1"," 0.4829965"
"1"," 0.4412410"
"1","
"
"1","[144]"
"1"," 0.5188123"
"1"," 0.2609662"
"1"," 0.5493850"
"1"," 0.3878454"
"1"," 0.4882318"
"1"," 0.2990332"
"1"," 0.4685037"
"1"," 0.2185400"
"1"," 0.5094090"
"1"," 0.8632975"
"1"," 0.3459631"
"1","
"
"1","[155]"
"1"," 0.2942354"
"1"," 0.2213127"
"1"," 0.3813400"
"1"," 0.4054227"
"1"," 0.3300665"
"1"," 0.4415409"
"1"," 0.3920208"
"1"," 0.2893425"
"1"," 0.4056204"
"1"," 0.3441323"
"1"," 0.4203055"
"1","
"
"1","[166]"
"1"," 0.4580064"
"1"," 0.3737216"
"1"," 0.6470150"
"1"," 0.2967261"
"1"," 0.3198735"
"1"," 0.4329634"
"1"," 2.0509168"
"1"," 0.6039674"
"1"," 0.5966302"
"1"," 0.6940269"
"1"," 0.5782434"
"1","
"
"1","[177]"
"1"," 0.6126062"
"1"," 0.6956880"
"1"," 0.6454073"
"1","
"
"0","# Loading plot"
"0","pls_model <- plsr(Y ~ X, ncomp = optimal_components, data = SeasonFood, validation = ""CV"")"
"0","loadingplot(pls_model, comps = 1:optimal_components, legendpos = ""topright"","
"0","            xlab = ""Contributor"", ylab = ""Loadings"","
"0","            main = ""PLS Loadings Plot"")"
