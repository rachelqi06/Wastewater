"0",""
"0",""
"0","# get PC rotations (contributions) from PCA object"
"0","pca.contri <- data.frame(res.pca$rotation) %>%"
"0","  rownames_to_column(var = ""Fish"")"
"0",""
"0","# Filter for the top 20 factors with the highest absolute values"
"0","top_factors <- pca.contri %>%"
"0","  mutate(abs_value = abs(PC1)) %>%  # Create a column for the absolute values"
"0","  arrange(desc(abs_value)) %>%  # Sort by absolute value in descending order"
"0","  slice(1:20)  # Select the top 20 rows"
"0",""
"0","# Plot PC1 components"
"0","PC1_loading <- ggplot(top_factors, aes(x = reorder(Fish, PC1), y = PC1, fill = Fish)) + "
"0","  geom_bar(stat = ""identity"", fill = ""#FA8072"", color = ""black"", linewidth = 0.2) +  # Use geom_bar and set stat to ""identity"" to use actual y values"
"0","  labs(x = ""Fish type"", y = ""PC1 Loading"") +  # Label the chart and axes"
"0","  theme_classic() +"
"0","  theme(text = element_text(color = ""black""))+"
"0","  coord_flip()"
"0",""
"0","PC1_loading"
