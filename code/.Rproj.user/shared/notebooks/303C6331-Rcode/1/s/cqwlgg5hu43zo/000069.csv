"0","#Use following subset"
"0","NCWW_2021_fish_clr"
"1","phyloseq-class experiment-level object"
"1","
"
"1","otu_table()   OTU Table:         [ 54 taxa and 39 samples ]"
"1","
"
"1","sample_data() Sample Data:       [ 39 samples by 64 sample variables ]"
"1","
"
"1","tax_table()   Taxonomy Table:    [ 54 taxa by 15 taxonomic ranks ]"
"1","
"
"1","phy_tree()    Phylogenetic Tree: [ 54 tips and 53 internal nodes ]"
"1","
"
"0","#PCA from prcomp()"
"0","df <- data.frame(NCWW_2021_fish_clr@otu_table) #count table"
"0","colnames(df) <- data.frame(NCWW_2021_fish_clr@tax_table)$CommonName"
"0",""
"0","unique_names <- make.unique(names(df), sep = ""."")"
"0","df_unique <- df"
"0","names(df_unique) <- unique_names"
"0",""
"0","# PCA by prcomp() on count table"
"0","pca_df <- df_unique"
"0","metadata <- data.frame(NCWW_2021_fish_clr@sam_data)"
"0","pca_df$Location <- metadata$Location"
"0",""
"0","# from combined_df, calculate the average read counts by Location"
"0","pca_df <- pca_df %>% "
"0","  group_by(Location) %>%"
"0","  summarise(across("
"0","    .cols = where(is.numeric),  # Selects all numeric columns"
"0","    .fns = ~ mean(.x, na.rm = TRUE)  # Calculate the mean, remove NA values"
"0","  )) %>%"
"0","  ungroup() %>%  # Remove grouping"
"0","  column_to_rownames(""Location"")  # Convert 'Location' column to row names"
"0",""
"0","res.pca <- prcomp(pca_df)"
"0","pc_loadings_fish <- merge(res.pca$x, Demographics_scaled, by.x = 0, by.y = 0)"
"0",""
"0","library(factoextra)"
"0",""
"0","df_locations <- data.frame("
"0","  Location = row.names(pca_df),"
"0","  Coast_Inland = metadata$Coast_Inland[match(row.names(pca_df), metadata$Location)]"
"0",")"
"0",""
"0","plot_pca <- fviz_pca_biplot(res.pca, repel = TRUE, "
"0","                habillage = df_locations$Coast_Inland,"
"0","                #label = ""var"","
"0","                col.var = ""black"", # Variables color"
"0","                col.ind = ""gray"",  # Individuals color"
"0","                alpha.ind = 0.8,"
"0","                #invisible = ""var"", # choose to not show var or ind or none"
"0","                select.var = list(contrib = 15), pointsize = 5, labelsize = 5,"
"0","                ggtheme = theme_void()) + theme(panel.grid.major = element_blank(),  # Remove major grid lines"
"0","    panel.grid.minor = element_blank(),  # Remove minor grid lines,"
"0","    text = element_text(size = 10),"
"0","        axis.title = element_text(size = 12),"
"0","        axis.text = element_text(size = 12)) + scale_color_brewer(palette=""Dark2"")"
"0","plot_pca"
