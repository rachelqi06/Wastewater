"0",""
"0","#Fit the model with optimal components"
"0","optimal_components <- which.min(pls_model$validation$PRESS)"
"0","pls_model <- plsr(Y1 ~ Demographics_scaled, ncomp = optimal_components, data = NCWW_fishPC, validation = ""CV"")"
"0","summary(pls_model)"
"1","Data: 	X dimension:"
"1"," "
"1","19"
"1"," "
"1","37"
"1"," "
"1","
	Y dimension:"
"1"," "
"1","19"
"1"," "
"1","1"
"1","
Fit method:"
"1"," "
"1","kernelpls"
"1","
Number of components considered:"
"1"," "
"1","2"
"1","

VALIDATION: RMSEP"
"1","
Cross-validated using"
"1"," "
"1","10"
"1"," "
"1","random"
"1"," "
"1","segments.
"
"1","     "
"1","  (Intercept)"
"1","  1 comps"
"1","  2 comps"
"1","
CV   "
"1","        2.385"
"1","    2.019"
"1","    1.852"
"1","
adjCV"
"1","        2.385"
"1","    2.005"
"1","    1.829"
"1","
"
"1","
TRAINING: % variance explained
"
"1","  "
"1","  1 comps"
"1","  2 comps"
"1","
X "
"1","    31.03"
"1","    56.08"
"1","
Y1"
"1","    49.38"
"1","    67.50"
"1","
"
"0","# Calculate RSME-P"
"0","RMSEP(pls_model)"
"1","     "
"1","  (Intercept)"
"1","  1 comps"
"1","  2 comps"
"1","
CV   "
"1","        2.385"
"1","    2.019"
"1","    1.852"
"1","
adjCV"
"1","        2.385"
"1","    2.005"
"1","    1.829"
"1","
"
"0","# Calculate VIP scores"
"0","vip_scores <- calculate_vip(pls_model)"
"0","vip_scores"
"1"," [1]"
"1"," 1.29859083"
"1"," 0.68411208"
"1"," 0.76759637"
"1"," 0.96493154"
"1"," 1.16294755"
"1"," 1.13938550"
"1"," 0.92124195"
"1"," 0.69078214"
"1"," 1.14842215"
"1"," 0.81421754"
"1","
"
"1","[11]"
"1"," 0.76251941"
"1"," 0.51382328"
"1"," 1.17879250"
"1"," 1.07755540"
"1"," 0.65302339"
"1"," 1.07232857"
"1"," 0.94680459"
"1"," 0.93743633"
"1"," 0.93649702"
"1"," 0.77175397"
"1","
"
"1","[21]"
"1"," 1.34219053"
"1"," 1.03409273"
"1"," 1.13150592"
"1"," 0.91422209"
"1"," 0.77175397"
"1"," 1.34219053"
"1"," 1.07863705"
"1"," 0.07569502"
"1"," 0.90738607"
"1"," 0.81683255"
"1","
"
"1","[31]"
"1"," 0.83183942"
"1"," 0.92475653"
"1"," 1.81580048"
"1"," 0.66612961"
"1"," 1.42752852"
"1"," 0.99768259"
"1"," 0.88416272"
"1","
"
"0","loadingplot(pls_model, comps = 1:optimal_components, legendpos = ""topright"","
"0","            xlab = ""Contributor"", ylab = ""Loadings"","
"0","            main = ""PLS Loadings Plot"")"
