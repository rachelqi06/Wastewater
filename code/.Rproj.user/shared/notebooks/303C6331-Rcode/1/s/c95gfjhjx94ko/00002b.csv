"0","#Use following subset"
"0","NCWW_2021_plant_clr"
"1","phyloseq-class experiment-level object"
"1","
"
"1","otu_table()   OTU Table:         [ 136 taxa and 39 samples ]"
"1","
"
"1","sample_data() Sample Data:       [ 39 samples by 64 sample variables ]"
"1","
"
"1","tax_table()   Taxonomy Table:    [ 136 taxa by 15 taxonomic ranks ]"
"1","
"
"0","#PCA from prcomp()"
"0","df <- data.frame(NCWW_2021_plant_clr@otu_table) #count table"
"0","colnames(df) <- data.frame(NCWW_2021_plant_clr@tax_table)$CommonName"
"0",""
"0","unique_names <- make.unique(names(df), sep = ""."")"
"0","df_unique <- df"
"0","names(df_unique) <- unique_names"
"0",""
"0","# PCA by prcomp() on count table"
"0","pca_df <- df_unique"
"0","metadata <- data.frame(NCWW_2021_plant_clr@sam_data)"
"0","pca_df$Location <- metadata$Location"
"0",""
"0","# from combined_df, calculate the average read counts by Location"
"0","pca_df <- pca_df %>% "
"0","  group_by(Location) %>%"
"0","  summarise(across("
"0","    .cols = where(is.numeric),  # Selects all numeric columns"
"0","    .fns = ~ mean(.x, na.rm = TRUE)  # Calculate the mean, remove NA values"
"0","  )) %>%"
"0","  ungroup() %>%  # Remove grouping"
"0","  column_to_rownames(""Location"")  # Convert 'Location' column to row names"
"0",""
"0","res.pca <- prcomp(pca_df)"
"0","pc_loadings_plant <- merge(res.pca$x, Demographics_scaled, by.x = 0, by.y = 0)"
"0",""
"0","library(factoextra)"
"0","plot_pca <- fviz_pca_biplot(res.pca, repel = TRUE,              # label = ""var"" only display the labels for var."
"0","                col.var = ""red"", # Variables color"
"0","                col.ind = ""grey"",  # Individuals color"
"0","                select.var = list(contrib = 15), pointsize = 3, labelsize = 5,"
"0","                ggtheme = theme_minimal()) + theme(text = element_text(size = 12),"
"0","        axis.title = element_text(size = 12),"
"0","        axis.text = element_text(size = 12))"
"0","plot_pca"
