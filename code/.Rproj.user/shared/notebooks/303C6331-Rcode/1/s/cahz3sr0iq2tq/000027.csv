"0","#Plant (From NCWW_allsamples_plants)"
"0","NCWW_allsamples_trnL"
"1","phyloseq-class experiment-level object"
"1","
"
"1","otu_table()   OTU Table:         [ 793 taxa and 182 samples ]"
"1","
"
"1","sample_data() Sample Data:       [ 182 samples by 64 sample variables ]"
"1","
"
"1","tax_table()   Taxonomy Table:    [ 793 taxa by 15 taxonomic ranks ]"
"1","
"
"0","#total reads of trnL"
"0","sum(taxa_sums(NCWW_allsamples_trnL))"
"1","[1]"
"1"," 1213890"
"1","
"
"0","#Food plant"
"0","food_plant <- subset_taxa(NCWW_allsamples_trnL, phylum == ""Streptophyta"")"
"0","food_plant"
"1","phyloseq-class experiment-level object"
"1","
"
"1","otu_table()   OTU Table:         [ 185 taxa and 182 samples ]"
"1","
"
"1","sample_data() Sample Data:       [ 182 samples by 64 sample variables ]"
"1","
"
"1","tax_table()   Taxonomy Table:    [ 185 taxa by 15 taxonomic ranks ]"
"1","
"
"0","#Food plant reads"
"0","sum(taxa_sums(food_plant))"
"1","[1]"
"1"," 929216"
"1","
"
"0","#Non-food plant reads"
"0","sum(taxa_sums(NCWW_allsamples_trnL)) - sum(taxa_sums(food_plant))"
"1","[1]"
"1"," 284673.6"
"1","
"
"0","#Percent of food plant reads in all samples"
"0","sum(taxa_sums(food_plant))/sum(taxa_sums(NCWW_allsamples_trnL))*100"
"1","[1]"
"1"," 76.54864"
"1","
"
"0","#Create a table to display percentage of food plant reads in each sample"
"0","# Get total reads per sample"
"0","total_reads_per_sample <- sample_sums(NCWW_allsamples_trnL)"
"0",""
"0","# Get food plant reads per sample"
"0","food_plant <- subset_taxa(NCWW_allsamples_trnL, phylum == ""Streptophyta"")"
"0","food_plant_reads_per_sample <- sample_sums(food_plant)"
"0",""
"0","# Calculate unassigned (non-food plant) reads per sample"
"0","non_food_reads_per_sample <- total_reads_per_sample - food_plant_reads_per_sample"
"0",""
"0","# Calculate percentage of unassigned reads per sample"
"0","percent_non_food_reads <- (non_food_reads_per_sample / total_reads_per_sample) * 100"
"0",""
"0","# Create a table"
"0","not_assigned_reads_table <- data.frame("
"0","  Sample = names(total_reads_per_sample),"
"0","  Total_Reads = total_reads_per_sample,"
"0","  Food_Plant_Reads = food_plant_reads_per_sample,"
"0","  Non_Food_Plant_Reads = non_food_reads_per_sample,"
"0","  Percent_Non_Food_Reads = percent_non_food_reads"
"0",")"
"0",""
"0","# Print the table"
"0","print(not_assigned_reads_table)"
