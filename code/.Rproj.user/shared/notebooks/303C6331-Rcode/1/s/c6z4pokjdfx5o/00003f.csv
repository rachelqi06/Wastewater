"0","#Data file used:"
"0","ps <- NCWW_2021_animal_clr"
"0","library(readxl)"
"2","Warning: package ‘readxl’ was built under R version 4.4.3"
"0","AgriculturalProduction <- read_excel(""Data/AgriculturalProduction_log_byCounty.xlsx"")"
"0",""
"0","#Extract data frame from phyloseq object"
"0","df <- data.frame(ps@otu_table)"
"0","colnames(df) <- data.frame(ps@tax_table)$CommonName"
"0","colnames(df) <- make.names(colnames(df), unique = TRUE)"
"0","metadata <- data.frame(ps@sam_data)"
"0","df$County <- metadata$County"
"0",""
"0","#Signal of major agricultural animals"
"0","WastewaterSignals <- df[, c(""County"",""Cattle.1"",""Chicken"", ""Turkey"",""Pig"")]"
"0",""
"0","# Add columns from AgriculturalProduction to df using match()"
"0","WastewaterSignals$Cattle_production <- AgriculturalProduction$Cattle_2021[match(WastewaterSignals$County, AgriculturalProduction$County)]"
"0","WastewaterSignals$Hog_production <- AgriculturalProduction$Hog_2021[match(WastewaterSignals$County, AgriculturalProduction$County)]"
"0","WastewaterSignals$Turkey_production <- AgriculturalProduction$Turkey_2021[match(WastewaterSignals$County, AgriculturalProduction$County)]"
"0","WastewaterSignals$Chicken_production <- AgriculturalProduction$Broiler_2021[match(WastewaterSignals$County, AgriculturalProduction$County)]"
"0",""
"0","#Plot the scatter plots"
"0","scatter1 <- ggscatter(WastewaterSignals, x = ""Cattle_production"", y = ""Cattle.1"", size = 4, color = ""#FA8072"", alpha = 0.6, repel = FALSE,  font.label = c(9, ""plain"", ""black""),"
"0","          add = ""reg.line"", add.params = list(color = ""blue"", fill = ""lightgray""),"
"0","          conf.int = TRUE, "
"0","          cor.coef = TRUE, cor.method = ""spearman"","
"0","          cor.coeff.args = list(method = ""spearman"", label.x.npc = ""left"", label.y.npc = ""top""),"
"0","          xlab = ""Cattle Production (log head)"", ylab = ""Wastewater Signal"")+"
"0","  theme_classic() +"
"0","  theme(panel.border = element_rect(color = ""black"", fill = NA), # Adds an outer frame"
"0","        axis.line = element_line(color = ""black""),               # Keeps axis lines"
"0","        panel.grid = element_blank())                            # Ensures no inner grid lines"
"0","scatter1"
