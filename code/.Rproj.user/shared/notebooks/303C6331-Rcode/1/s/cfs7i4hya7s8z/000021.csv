"0",""
"0","##Plot coeffients"
"0","pls.contri <- data.frame(pls_model$coefficients)"
"0","pls.contri <- rownames_to_column(pls.contri, var = ""Factor"")"
"0",""
"0","# Add VIP scores to the data frame"
"0","pls.contri <- pls.contri %>%"
"0","  mutate(VIP = vip_scores)"
"0",""
"0","# Filter for the top 20 factors with the highest absolute Y_ratio.1.comps"
"0","top_factors <- pls.contri %>%"
"0","  mutate(abs_value = abs(Y.1.comps)) %>%  # Create a column for the absolute values"
"0","  arrange(desc(abs_value)) %>%  # Sort by absolute value in descending order"
"0","  slice(1:20)  # Select the top 20 rows"
"0",""
"0","# Plot with VIP labels"
"0","PLSC1_coefficients <- ggplot(top_factors, aes(x = reorder(Factor, Y.1.comps), y = Y.1.comps)) + "
"0","  geom_bar(stat = ""identity"", aes(alpha = VIP), fill = ""#FA8072"", color = ""black"", linewidth = 0.2) + # Bar plot #FA8072 for animal, #B09647 for plant"
"0","  geom_text(aes(label = round(VIP, 2)),  # Set label position to the 0 line"
"0","            hjust = -0.2, size = 3, color = ""black"") +  # Adjust label alignment and size# Map alpha to VIP"
"0","  scale_alpha_continuous(range = c(0.3, 1)) +  # Set transparency range: lower scores are more transparent"
"0","  labs(x = ""Top 20 Taxa"", y = ""Loading"", title = ""Animal taxa predicting per capita income"") +  # Label chart and axes"
"0","  theme_classic() +"
"0","  theme(text = element_text(color = ""black"")) +"
"0","  coord_flip()"
"0",""
"0","PLSC1_coefficients"
