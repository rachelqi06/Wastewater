"0",""
"0","#Fit the model with optimal components"
"0","optimal_components <- which.min(pls_model$validation$PRESS)"
"0","pls_model <- plsr(Y ~ X, ncomp = optimal_components, data = NCWW_Income, validation = ""CV"")"
"0",""
"0","summary(pls_model)"
"1","Data: 	X dimension:"
"1"," "
"1","39"
"1"," "
"1","136"
"1"," "
"1","
	Y dimension:"
"1"," "
"1","39"
"1"," "
"1","1"
"1","
Fit method:"
"1"," "
"1","kernelpls"
"1","
Number of components considered:"
"1"," "
"1","3"
"1","

VALIDATION: RMSEP"
"1","
Cross-validated using"
"1"," "
"1","10"
"1"," "
"1","random"
"1"," "
"1","segments.
"
"1","     "
"1","  (Intercept)"
"1","  1 comps"
"1","  2 comps"
"1","  3 comps"
"1","
CV   "
"1","        8.097"
"1","    4.899"
"1","    4.565"
"1","    4.649"
"1","
adjCV"
"1","        8.097"
"1","    4.800"
"1","    4.448"
"1","    4.466"
"1","
"
"1","
TRAINING: % variance explained
"
"1"," "
"1","  1 comps"
"1","  2 comps"
"1","  3 comps"
"1","
X"
"1","    9.186"
"1","    16.12"
"1","    20.90"
"1","
Y"
"1","   82.741"
"1","    92.21"
"1","    96.67"
"1","
"
"0","# Calculate RSME-P"
"0","RMSEP(pls_model)"
"1","     "
"1","  (Intercept)"
"1","  1 comps"
"1","  2 comps"
"1","  3 comps"
"1","
CV   "
"1","        8.097"
"1","    4.899"
"1","    4.565"
"1","    4.649"
"1","
adjCV"
"1","        8.097"
"1","    4.800"
"1","    4.448"
"1","    4.466"
"1","
"
"0","# Calculate VIP scores"
"0","vip_scores <- calculate_vip(pls_model)"
"0",""
"0","##Loading plot"
"0","loadingplot(pls_model, comps = 1:optimal_components, legendpos = ""topright"","
"0","            xlab = ""Contributor"", ylab = ""Loadings"","
"0","            main = ""PLS Loadings Plot"")"
